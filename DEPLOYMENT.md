# 🚀 Быстрое развертывание Baz Car API

## ⚡ Одна команда для всего

```bash
./safe_start.sh
```

**Эта команда автоматически:**
- ✅ Остановит старый сервер
- ✅ Обновит зависимости
- ✅ Выполнит миграции БД
- ✅ Создаст резервную копию
- ✅ Запустит новый сервер

## 🔄 Процесс обновления на бэкенде

### 1. Остановка
```bash
pkill -f uvicorn
```

### 2. Обновление кода
```bash
git pull origin main
```

### 3. Запуск с миграциями
```bash
./safe_start.sh
```

**Готово!** 🎉

## 🛡️ Безопасность данных

- **Автоматические резервные копии** перед каждой миграцией
- **Транзакционные миграции** - откат при ошибках
- **История миграций** - отслеживание изменений
- **Проверка целостности** - валидация данных

## 📊 Мониторинг

### Проверка статуса
```bash
python check_migrations.py
```

### Проверка сервера
```bash
curl http://localhost:8080/health
```

### Логи
```bash
tail -f server.log
```

## 🆘 Если что-то пошло не так

### Восстановление из резервной копии
```bash
# 1. Остановить сервер
pkill -f uvicorn

# 2. Восстановить БД
cp baz_car_backup_TIMESTAMP.db baz_car.db

# 3. Запустить заново
./safe_start.sh
```

### Очистка портов
```bash
# Найти процессы на порту 8080
lsof -i :8080

# Остановить их
kill PID_NUMBER
```

## 📁 Структура проекта

```
baz-car-py/
├── safe_start.sh          # 🚀 Безопасный запуск
├── auto_migrate.sh         # 🔧 Только миграции
├── check_migrations.py    # 📊 Статус миграций
├── migrations/             # 📁 Файлы миграций
│   ├── 001_*.py
│   ├── 002_*.py
│   └── ...
├── baz_car.db             # 💾 База данных
├── baz_car_backup_*.db     # 💾 Резервные копии
└── server.log              # 📋 Логи сервера
```

## 🎯 Основные команды

| Команда | Описание |
|---------|----------|
| `./safe_start.sh` | 🚀 Полный безопасный запуск |
| `./auto_migrate.sh` | 🔧 Только миграции |
| `python check_migrations.py` | 📊 Статус миграций |
| `pkill -f uvicorn` | 🛑 Остановка сервера |
| `tail -f server.log` | 📋 Просмотр логов |

---

**🎉 Теперь обновления безопасны и автоматизированы!**
